{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user in the Apex Case Battles app.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the User entity."
        },
        "telegramId": {
          "type": "string",
          "description": "The user's Telegram ID, used for authentication."
        },
        "username": {
          "type": "string",
          "description": "The user's username."
        },
        "starsBalance": {
          "type": "number",
          "description": "The user's Stars balance."
        },
        "referralCode": {
          "type": "string",
          "description": "The user's unique referral code."
        },
        "invitedById": {
          "type": "string",
          "description": "Reference to the User who invited this user."
        },
        "referralsCount": {
          "type": "number",
          "description": "The number of users this user has referred."
        },
        "spinsCountWeekly": {
          "type": "number",
          "description": "The number of spins the user has used this week."
        },
        "starsSpentWeekly": {
          "type": "number",
          "description": "The number of Stars the user has spent this week."
        }
      },
      "required": [
        "id",
        "telegramId",
        "username",
        "starsBalance",
        "referralCode"
      ]
    },
    "Case": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Case",
      "type": "object",
      "description": "Represents a case that users can open.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Case entity."
        },
        "nameEn": {
          "type": "string",
          "description": "The English name of the case."
        },
        "priceStars": {
          "type": "number",
          "description": "The price of the case in Stars."
        },
        "imageUrl": {
          "type": "string",
          "description": "The URL of the case's image."
        },
        "isFree": {
          "type": "boolean",
          "description": "Whether the case is free to open."
        },
        "freeCooldownSeconds": {
          "type": "number",
          "description": "The cooldown time in seconds before a free case can be opened again."
        },
        "items": {
          "type": "array",
          "description": "Array of items contained in this case with their probabilities.",
          "items": {
            "type": "object",
            "properties": {
              "itemId": {
                "type": "string"
              },
              "probability": {
                "type": "number"
              }
            }
          }
        }
      },
      "required": [
        "id",
        "nameEn",
        "priceStars",
        "imageUrl"
      ]
    },
    "NFTInventory": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "NFTInventory",
      "type": "object",
      "description": "Represents the inventory of real TON NFTs owned by the bot.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the NFTInventory entity (nft_id)."
        },
        "collectionAddress": {
          "type": "string",
          "description": "The address of the NFT collection."
        },
        "caseId": {
          "type": "string",
          "description": "Reference to the Case this NFT can be won from."
        },
        "currentOwnerId": {
          "type": "string",
          "description": "Reference to the User or Bot that currently owns the NFT."
        },
        "status": {
          "type": "string",
          "description": "The status of the NFT (available, won, transferred).",
          "enum": ["available", "won", "transferred"]
        }
      },
      "required": [
        "id",
        "collectionAddress",
        "status"
      ]
    },
    "Inventory": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Inventory",
      "type": "object",
      "description": "Represents a list of items (including NFTs) won by users.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Inventory entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to the User who won the item."
        },
        "itemId": {
          "type": "string",
          "description": "Reference to the Item won."
        },
        "type": {
          "type": "string",
          "description": "The type of item (e.g., NFT, in-game item)."
        },
        "status": {
          "type": "string",
          "description": "The status of the item (won, exchanged, shipped).",
          "enum": ["won", "exchanged", "shipped"]
        },
        "wonAt": {
          "type": "string",
          "description": "The timestamp when the item was won.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "itemId",
        "type",
        "status",
        "wonAt"
      ]
    },
    "Item": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Item",
      "type": "object",
      "description": "Represents a generic item that can be won in the game (including NFTs).",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Item entity."
        },
        "name": {
          "type": "string",
          "description": "The name of the item."
        },
        "description": {
          "type": "string",
          "description": "The description of the item (can be generated by AI)."
        },
        "imageUrl": {
          "type": "string",
          "description": "The URL of the item's image."
        },
        "rarity": {
          "type": "string",
          "enum": ["Common", "Uncommon", "Rare", "Epic", "Legendary", "NFT"]
        },
        "value": {
          "type": "number",
          "description": "Value of the item in Stars."
        }
      },
      "required": [
        "id",
        "name",
        "imageUrl",
        "rarity",
        "value"
      ]
    }
  },
  "auth": {
    "providers": [
      "anonymous"
    ]
  },
  "firestore": {
    "/users/{userId}": {
      "schema": {
        "$ref": "#/entities/User"
      },
      "description": "Stores user data, including telegram ID, username, stars balance, and referral information. The 'userId' is the Firebase Auth UID."
    },
    "/cases/{caseId}": {
      "schema": {
        "$ref": "#/entities/Case"
      },
      "description": "Stores details about each case, including its price, contents, and probabilities."
    },
    "/nft_inventory/{nftId}": {
      "schema": {
        "$ref": "#/entities/NFTInventory"
      },
      "description": "Tracks all real TON NFTs owned by the bot, managing their availability and ownership status."
    },
    "/users/{userId}/inventory/{inventoryId}": {
      "schema": {
        "$ref": "#/entities/Inventory"
      },
      "description": "A subcollection for each user, storing the items they have won. This ensures data privacy and easy querying."
    },
    "/items/{itemId}": {
      "schema": {
        "$ref": "#/entities/Item"
      },
      "description": "A global collection of all possible items that can be won from cases."
    }
  }
}